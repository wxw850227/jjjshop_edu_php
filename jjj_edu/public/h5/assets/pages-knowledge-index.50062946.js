import{_ as a,s as t,c as e,B as s,D as o,o as l,a as i,w as c,f as r,d as n,e as g,n as d,b as h,r as _,F as u,i as p,I as f,t as m,p as y,k as C}from"./index-db1fe3c3.js";const k=a({data:()=>({searchName:"",category_id:0,phoneHeight:"",scrollviewHigh:"",page:1,list_rows:10,loading:!1,searchForm:{category_id:0,search:""},listData:[],last_page:1,no_more:!1,categorys:[]}),onLoad(){},onShow(){let a=this.$store._state.data.navTargetCategory;this.category_id=a||0,this.init(),this.page=1,this.listData=[],this.getCategory(),this.getData()},onHide(){this.$store.commit("changNavTargetCategory",0)},computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onReachBottom(){let a=this;a.page<a.last_page&&(a.page++,a.getData()),a.no_more=!0},methods:{init(){console.log("init");let a=this;t({success(t){a.phoneHeight=t.windowHeight,e().select(".top-box").boundingClientRect((t=>{let e=a.phoneHeight-t.height;a.scrollviewHigh=e})).exec()}})},getData(){let a=this,t=a.page,e=a.list_rows;a.loading=!0,s({title:"加载中"}),a._get("course.course/list",{page:t||1,list_rows:e,category_id:a.category_id||0,search:a.searchForm.search},(function(t){a.listData=a.listData.concat(t.data.list.data),a.last_page=t.data.list.last_page,t.data.list.last_page<=1&&(a.no_more=!0),a.loading=!1,o()}))},getCategory(){let a=this;a._get("course.category/index",{},(function(t){a.categorys=t.data.list}))},searchFunc(){this.page=1,this.listData=[],this.getData()},changeCat(a){let t=this;console.log("changeCat called with",a),t.category_id=a,t.page=1,t.listData=[],t.getData(),console.log(t.category_id)}}},[["render",function(a,t,e,s,o,k){const D=p,F=f,b=r,w=C;return l(),i(b,null,{default:c((()=>[n(b,{class:"top-box"},{default:c((()=>[n(b,{class:"top-search"},{default:c((()=>[n(b,{class:"search-box"},{default:c((()=>[n(D,{class:"icon iconfont icon-sousuo"}),n(F,{type:"text",class:"flex-1 search-input",onConfirm:t[0]||(t[0]=a=>k.searchFunc()),modelValue:o.searchForm.search,"onUpdate:modelValue":t[1]||(t[1]=a=>o.searchForm.search=a),placeholder:"请输入..."},null,8,["modelValue"]),n(b,{class:"search-btn",onClick:k.searchFunc},{default:c((()=>[g("搜索")])),_:1},8,["onClick"])])),_:1})])),_:1}),n(b,{class:"top-nav"},{default:c((()=>[n(b,{class:d(["top-nav-item",{active:0==o.category_id}]),onClick:t[2]||(t[2]=a=>k.changeCat(0))},{default:c((()=>[g("全部 ")])),_:1},8,["class"]),(l(!0),h(u,null,_(o.categorys,((a,t)=>(l(),i(b,{key:t,class:d(["top-nav-item",{active:o.category_id==a.category_id}]),onClick:t=>k.changeCat(a.category_id)},{default:c((()=>[g(m(a.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),n(b,{class:"pt24 data-list"},{default:c((()=>[(l(!0),h(u,null,_(o.listData,((t,e)=>(l(),i(b,{class:"data-item",key:e,onClick:e=>a.gotoPage("pages/knowledge/course/detail?course_id="+t.course_id)},{default:c((()=>[n(w,{class:"data-img",src:t.image?t.image.file_path:"",mode:""},null,8,["src"]),n(b,{class:"text-ellipsis-2 data-title"},{default:c((()=>[g(m(t.title),1)])),_:2},1024),n(b,{class:"d-b-c data-bottom"},{default:c((()=>[1==t.isFree?(l(),i(b,{key:0,class:"fb f30 redF24"},{default:c((()=>[g("免费")])),_:1})):y("",!0),2==t.isFree?(l(),i(b,{key:1,class:"fb f30 redF24"},{default:c((()=>[g("免费试看")])),_:1})):y("",!0),3==t.isFree?(l(),i(b,{key:2,class:"fb f30 redF24"},{default:c((()=>[g("￥"+m(t.course_price),1)])),_:2},1024)):y("",!0),n(b,{class:"gray9 f28"},{default:c((()=>[g("共"+m(t.sectionNum)+"节",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})}],["__scopeId","data-v-2f2b6fc8"]]);export{k as default};
