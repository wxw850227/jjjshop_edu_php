import{a as e,c as l,d as o,g as a,h as s,b as t,e as i,i as d,j as n,k as p,v as r,f as c,l as u}from"./element-plus-b1fe4ef5.js";import{r as m}from"./request-16c40424.js";import{_ as g}from"./index-ca2fca40.js";import{o as h,S as f,R as _,a as b,O as y,V,c as C,a8 as k,P as j,_ as D,ad as v,X as L,W as w}from"./@vue-413ce838.js";import{d as x}from"./base-1c9aa973.js";import"./lodash-es-12c6aa75.js";import"./async-validator-cf877c1f.js";import"./@vueuse-4fad2ccb.js";import"./dayjs-3a594381.js";import"./call-bind-8544b80b.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-1ce7f40b.js";import"./@popperjs-b78c3215.js";import"./escape-html-1590d737.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./axios-15f6fe35.js";import"./qs-c6aa5595.js";import"./side-channel-b02c3a2b.js";import"./object-inspect-bd98d4ca.js";import"./vue-router-569da8b3.js";import"./pinia-1c212f4d.js";let F={plugslist:(e,l)=>m._post("/admin/plus.plus/index",e,l),getplugs:(e,l)=>m._get("/admin/plus.plus/add",e,l),addplugs:(e,l)=>m._post("/admin/plus.plus/add",e,l),editplugs:(e,l)=>m._post("/admin/plus.plus/edit",e,l),deleteplugs:(e,l)=>m._post("/admin/plus.plus/delete",e,l),updatePlugsStatus:(e,l)=>m._post("/admin/plus.plus/updateStatus",e,l),updatePlugsRecom:(e,l)=>m._post("/admin/plus.plus/updateRecom",e,l)};const M={class:"dialog-footer"};const U={data:()=>({form:{status:0,srot:1,plus_name:"",desc:"",ico:"",url:"index/index",sort:1},categoryList:[],srot:"1",radio:"1",formLabelWidth:"120px",dialogVisible:!1,loading:!0}),props:{open_add:Boolean,curModel:Object},created(){this.dialogVisible=this.open_add,this.getCategoryList()},methods:{getCategoryList(){let e=this,l={plus_category_id:e.curModel.plus_category_id};F.getplugs(l,!0).then((l=>{e.loading=!1,e.categoryList=l.data.accessList})).catch((l=>{e.loading=!1}))},addClick(l){let o=this,a={access_id:l.access_id,plus_category_id:o.curModel.plus_category_id};F.addplugs(a,!0).then((l=>{o.loading=!1,1==l.code?(e({message:"恭喜你，添加成功",type:"success"}),o.dialogFormVisible(!0)):(o.loading=!1,e.error("错了哦，这是一条错误消息"))})).catch((e=>{o.loading=!1}))},dialogFormVisible(e){e?this.$emit("closeDialog",{type:"success",openDialog:!1}):this.$emit("closeDialog",{type:"error",openDialog:!1})}}};const W={class:"dialog-footer"};const z={components:{Edit:g({data:()=>({categoryList:[],formLabelWidth:"120px",dialogVisible:!1,loading:!1}),props:["open_edit","form"],created(){this.dialogVisible=this.open_edit,this.getCategoryList()},methods:{getCategoryList(){let e=this;F.plugslist({},!0).then((l=>{e.loading=!1,e.categoryList=l.data.accessList})).catch((e=>{}))},editPlugs(){let l=this,o=this.form;l.$refs.form.validate((a=>{a&&(l.loading=!0,F.editplugs(o,!0).then((o=>{l.loading=!1,e({message:"恭喜你，修改成功",type:"success"}),l.dialogFormVisible(!0)})).catch((e=>{})))}))},dialogFormVisible(e){e?this.$emit("closeDialog",{type:"success",openDialog:!1}):this.$emit("closeDialog",{type:"error",openDialog:!1})}}},[["render",function(e,n,p,r,c,u){const m=l,g=o,D=a,v=s,L=t,w=i,x=d;return h(),f(x,{title:"编辑插件",modelValue:c.dialogVisible,"onUpdate:modelValue":n[6]||(n[6]=e=>c.dialogVisible=e),onClose:u.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:_((()=>[b("div",M,[y(w,{onClick:u.dialogFormVisible},{default:_((()=>[V("取 消")])),_:1},8,["onClick"]),y(w,{type:"primary",onClick:u.editPlugs,loading:c.loading},{default:_((()=>[V("确 定")])),_:1},8,["onClick","loading"])])])),default:_((()=>[y(L,{size:"small",model:p.form,ref:"form"},{default:_((()=>[y(g,{label:"插件名称","label-width":c.formLabelWidth,rules:[{required:!0,message:" "}],prop:"plus_name"},{default:_((()=>[y(m,{modelValue:p.form.plus_name,"onUpdate:modelValue":n[0]||(n[0]=e=>p.form.plus_name=e),autocomplete:"off",placeholder:"请输入插件名称"},null,8,["modelValue"])])),_:1},8,["label-width"]),y(g,{label:"插件描述","label-width":c.formLabelWidth},{default:_((()=>[y(m,{modelValue:p.form.desc,"onUpdate:modelValue":n[1]||(n[1]=e=>p.form.desc=e),autocomplete:"off",placeholder:"请输入插件描述"},null,8,["modelValue"])])),_:1},8,["label-width"]),y(g,{label:"ico图标","label-width":c.formLabelWidth,rules:[{required:!0,message:" "}],prop:"ico"},{default:_((()=>[y(m,{modelValue:p.form.ico,"onUpdate:modelValue":n[2]||(n[2]=e=>p.form.ico=e),autocomplete:"off",placeholder:"请输入图标名名称"},null,8,["modelValue"])])),_:1},8,["label-width"]),y(g,{label:"插件分类","label-width":c.formLabelWidth},{default:_((()=>[y(v,{modelValue:p.form.parent_id,"onUpdate:modelValue":n[3]||(n[3]=e=>p.form.parent_id=e),placeholder:"请选择分类"},{default:_((()=>[y(D,{label:"顶级分类",value:0}),(h(!0),C(j,null,k(c.categoryList,((e,l)=>(h(),f(D,{key:l,label:e.plus_name,value:e.plus_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label-width"]),y(g,{label:"插件URL","label-width":c.formLabelWidth},{default:_((()=>[y(m,{modelValue:p.form.url,"onUpdate:modelValue":n[4]||(n[4]=e=>p.form.url=e),autocomplete:"off",placeholder:"例如：index/index"},null,8,["modelValue"])])),_:1},8,["label-width"]),y(g,{label:"排序","label-width":c.formLabelWidth,rules:[{required:!0,message:" "}],prop:"sort"},{default:_((()=>[y(m,{modelValue:p.form.sort,"onUpdate:modelValue":n[5]||(n[5]=e=>p.form.sort=e),placeholder:"请输入数字"},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model"])])),_:1},8,["modelValue","onClose"])}]]),Add:g(U,[["render",function(e,l,o,a,s,t){const c=n,u=i,m=p,g=d,b=r;return h(),f(g,{title:"添加插件",modelValue:s.dialogVisible,"onUpdate:modelValue":l[0]||(l[0]=e=>s.dialogVisible=e),onClose:t.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},{default:_((()=>[D((h(),f(m,{size:"small",data:s.categoryList,border:"",style:{width:"100%"}},{default:_((()=>[y(c,{prop:"name",label:"名称"}),y(c,{prop:"name",label:"操作",width:"80"},{default:_((e=>[y(u,{onClick:l=>t.addClick(e.row),size:"small"},{default:_((()=>[V("添加")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[b,s.loading]])])),_:1},8,["modelValue","onClose"])}]]),Type:g({data:()=>({form:{plus_name:""},formLabelWidth:"120px",dialogVisible:!1,loading:!1}),props:["open_type"],created(){this.dialogVisible=this.open_type},methods:{addClick(){let l=this,o=this.form;l.$refs.form.validate((a=>{a&&(l.loading=!0,F.addplugs(o,!0).then((o=>{l.loading=!1,1==o.code?(e({message:"恭喜你，添加成功",type:"success"}),l.dialogFormVisible(!0)):(l.loading=!1,e.error("错了哦，这是一条错误消息"))})).catch((e=>{l.loading=!1})))}))},dialogFormVisible(e){e?this.$emit("closeDialog",{type:"success",openDialog:!1}):this.$emit("closeDialog",{type:"error",openDialog:!1})}}},[["render",function(e,a,s,n,p,r){const c=l,u=o,m=t,g=i,C=d;return h(),f(C,{title:"添加类别",modelValue:p.dialogVisible,"onUpdate:modelValue":a[2]||(a[2]=e=>p.dialogVisible=e),onClose:r.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:_((()=>[b("div",W,[y(g,{onClick:r.dialogFormVisible},{default:_((()=>[V("取 消")])),_:1},8,["onClick"]),y(g,{type:"primary",onClick:a[1]||(a[1]=e=>r.addClick()),loading:p.loading},{default:_((()=>[V("确 定")])),_:1},8,["loading"])])])),default:_((()=>[y(m,{size:"small",model:p.form,ref:"form"},{default:_((()=>[y(u,{label:"类别名称","label-width":p.formLabelWidth},{default:_((()=>[y(c,{modelValue:p.form.plus_name,"onUpdate:modelValue":a[0]||(a[0]=e=>p.form.plus_name=e),autocomplete:"off",placeholder:"请输入类别名称"},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model"])])),_:1},8,["modelValue","onClose"])}]])},data:()=>({loading:!0,tableData:[],totalDataNumber:0,open_add:!1,open_edit:!1,open_type:!1,curModel:{}}),created(){this.getData()},methods:{getData(){let e=this;F.plugslist({},!0).then((l=>{e.loading=!1,e.tableData=l.data.accessList,e.totalDataNumber=l.data.list.total})).catch((l=>{e.loading=!1}))},addType(){this.open_type=!0},statusChange:function(e,l){let o=this;o.loading=!0,F.updatePlugsStatus({plus_id:l.plus_id},!0).then((a=>{o.loading=!1,l.status=e})).catch((a=>{o.loading=!1,l.status=!e}))},recomChange:function(e,l){let o=this;o.loading=!0,F.updatePlugsRecom({plus_id:l.plus_id},!0).then((a=>{o.loading=!1,l.is_recom=e})).catch((a=>{o.loading=!1,l.is_recom=!e}))},addClick(e){this.curModel=e,this.open_add=!0},editClick(e){this.userModel=x(e),this.open_edit=!0},closeDialogFunc(e,l){"type"==l&&(this.open_type=e.openDialog,"success"==e.type&&this.tableData.push({plus_name:"新类别"})),"add"==l&&(this.open_add=e.openDialog,"success"==e.type&&this.getData()),"edit"==l&&(this.open_edit=e.openDialog,"success"==e.type&&this.getData())},deleteClick(l){let o=this;c.confirm("删除后不可恢复，确认删除该记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{o.loading=!0,F.deleteplugs({plus_id:l.access_id},!0).then((l=>{1==l.code&&(o.loading=!1,e({message:l.msg,type:"success"}),o.getData())})).catch((e=>{o.loading=!1}))})).catch((()=>{}))}}},P={class:"plus-container"},$=b("div",{class:"common-level-rail"},null,-1),q={class:"common-form d-s-c"},R={class:"plus-list"},T={class:"item-box pr"},B=["onClick"],S=b("span",{class:"iconfont icon icon-tubiaozhizuomoban-"},null,-1),A={class:"ml10"},E={class:"item"},N={class:"d-s-c mt10"},O=["onClick"],G=b("div",{class:"ml10"},[b("p",{class:"f14 gray9"},"添加插件到此类别下")],-1);const H=g(z,[["render",function(e,l,o,a,s,t){const i=v("CloseBold"),d=u,n=v("Plus"),p=v("Type"),r=v("Add"),c=v("Edit");return h(),C("div",P,[$,(h(!0),C(j,null,k(s.tableData,((e,l)=>(h(),C("div",{key:l,class:"mb16"},[b("div",q,[b("span",null,w(e.name),1)]),b("div",R,[(h(!0),C(j,null,k(e.children,((e,l)=>(h(),C("div",{class:"item",key:l},[b("div",T,[b("a",{href:"javascript:void(0);",class:"close-btn",onClick:l=>t.deleteClick(e)},[y(d,{size:20},{default:_((()=>[y(i)])),_:1})],8,B),b("a",null,[S,b("div",A,[b("h3",null,w(e.name),1),b("p",null,w(e.remark),1)])])])])))),128)),b("div",E,[b("div",N,[b("div",{class:"add-item-box d-c-c",onClick:l=>t.addClick(e)},[y(d,null,{default:_((()=>[y(n)])),_:1})],8,O),G])])])])))),128)),s.open_type?(h(),f(p,{key:0,open_type:s.open_type,onCloseDialog:l[0]||(l[0]=e=>t.closeDialogFunc(e,"type"))},null,8,["open_type"])):L("",!0),s.open_add?(h(),f(r,{key:1,open_add:s.open_add,curModel:s.curModel,onCloseDialog:l[1]||(l[1]=e=>t.closeDialogFunc(e,"add"))},null,8,["open_add","curModel"])):L("",!0),s.open_edit?(h(),f(c,{key:2,open_edit:s.open_edit,curModel:s.curModel,onCloseDialog:l[2]||(l[2]=e=>t.closeDialogFunc(e,"edit"))},null,8,["open_edit","curModel"])):L("",!0)])}]]);export{H as default};
