import{E as e,t,u as i,f as o,c as s,v as a}from"./element-plus-fe2e4fed.js";import{P as r}from"./paper-c44d6768.js";import n from"./Basic-56ee5cae.js";import m from"./Question-27a6bbcf.js";import{ae as p,$ as d,o as l,c as u,P as c,S as _,T as f,a0 as g,a as j,W as y,Y as q}from"./@vue-0361ad4a.js";import{_ as h}from"./index-68daabb5.js";import"./lodash-es-3593bb86.js";import"./async-validator-cf877c1f.js";import"./@vueuse-19751edd.js";import"./dayjs-3a594381.js";import"./call-bind-8544b80b.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-1634e2d0.js";import"./@popperjs-b78c3215.js";import"./escape-html-1590d737.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./Upload-f5c061cf.js";import"./AddCategory-d39c217d.js";import"./file-498fee0c.js";import"./vuedraggable-cabcff94.js";import"./vue-3c8001f5.js";import"./sortablejs-c079517e.js";import"./vue-router-64e93849.js";import"./pinia-3f36854e.js";import"./axios-15f6fe35.js";import"./qs-c6aa5595.js";import"./side-channel-b02c3a2b.js";import"./object-inspect-bd98d4ca.js";import"./vue-clipboard2-259f629a.js";import"./clipboard-e6665d4e.js";import"./vue-ueditor-wrap-f5452c05.js";import"./question-22f139d5.js";const v={class:"product-add"},b={class:"common-button-wrapper",style:{height:"50px"}};const x=h({components:{Basic:n,Questionindex:m},data:()=>({save_loading:!1,activeName:"basic",loading:!1,paper_id:0,scene:"edit",form:{model:{paper_paper_id:0,title:"",image_id:"",item_number:"",virtual_answer:"",single_number:"",single_score:"",many_number:"",many_score:"",judge_number:"",judge_score:"",difficulty:null,sort:0,is_score:0,is_show:0,virtual_sales:0,question:[],single:[],many:[],judge:[]},category:[],questionType:[],single:[],many:[],judge:[]}}),provide:function(){return{form:this.form}},created(){this.paper_id=this.$route.query.paper_id,this.scene=this.$route.query.scene,this.getData()},methods:{getData:function(){let e=this;r.getEdittrainPaper({paper_id:e.paper_id,scene:e.scene},!0).then((t=>{e.loading=!1,Object.assign(e.form,t.data);let i={};e.form.model.single.length>0&&e.form.model.single.forEach(((t,o)=>{i={question_id:t.question_id,category:{name:t.question.category.name},type_name:t.question.type_name,title:t.question.title,sort:t.question.sort,question_type:t.question_type,question_id:t.question_id,paper_question_id:t.paper_question_id,paper_id:t.paper_id},e.form.single.push(i)}));let o={};e.form.model.many.length>0&&e.form.model.many.forEach(((t,i)=>{o={question_id:t.question_id,category:{name:t.question.category.name},type_name:t.question.type_name,title:t.question.title,sort:t.question.sort,question_type:t.question_type,question_id:t.question_id,paper_question_id:t.paper_question_id,paper_id:t.paper_id},e.form.many.push(o)}));let s={};e.form.model.judge.length>0&&e.form.model.judge.forEach(((t,i)=>{s={question_id:t.question_id,category:{name:t.question.category.name},type_name:t.question.type_name,title:t.question.title,sort:t.question.sort,question_type:t.question_type,question_id:t.question_id,paper_question_id:t.paper_question_id,paper_id:t.paper_id},e.form.judge.push(s)})),e.form.model.single=e.form.single,e.form.model.many=e.form.many,e.form.model.judge=e.form.judge})).catch((t=>{e.loading=!1}))},convertJson(e){let t={};return e.forEach((e=>{t[e.grade_id]=e.product_equity})),JSON.stringify(t)},onSubmit:function(t){let i=this;i.$refs.form.validate((t=>{if(t){let t=i.form.model;t.scene=i.scene,t.paper_id=i.paper_id,t.question=[...i.form.model.single,...i.form.model.many,...i.form.model.judge],i.save_loading=!0,t=JSON.stringify(t),r.edittrainPaper({params:t},!0).then((t=>{i.save_loading=!1,e({message:"保存成功",type:"success"}),i.cancelFunc()})).catch((e=>{i.save_loading=!1}))}else e({message:"请检查必填项是否填写完整",type:"error"})}))},ImgKeepId(e){let t=[];for(let i=0,o=e.length;i<o;i++){let o={image_id:e[i].image_id,file_id:e[i].file_id};t.push(o)}return t},Draft(){this.form.model.product_status=30,this.onSubmit()},cancelFunc(){this.$router.back(-1)}}},[["render",function(e,r,n,m,h,x){const w=t,N=i,k=p("Basic"),E=p("Questionindex"),S=o,z=s,$=a;return d((l(),u("div",v,[c(N,{modelValue:h.activeName,"onUpdate:modelValue":r[0]||(r[0]=e=>h.activeName=e),type:"card"},{default:_((()=>[c(w,{label:"基础设置",name:"basic"}),c(w,{label:"答案解析",name:"question"})])),_:1},8,["modelValue"]),h.loading?q("",!0):(l(),f(z,{key:0,size:"small",ref:"form",model:h.form,"label-width":"180px"},{default:_((()=>[d(c(k,null,null,512),[[g,"basic"==h.activeName]]),d(c(E,null,null,512),[[g,"question"==h.activeName]]),j("div",b,[c(S,{size:"small",type:"info",onClick:x.cancelFunc},{default:_((()=>[y("取消")])),_:1},8,["onClick"]),c(S,{size:"small",type:"primary",onClick:r[1]||(r[1]=e=>x.onSubmit("edit")),disabled:h.save_loading},{default:_((()=>[y("发布 ")])),_:1},8,["disabled"])])])),_:1},8,["model"]))])),[[$,h.loading]])}],["__scopeId","data-v-84780ed1"]]);export{x as default};
