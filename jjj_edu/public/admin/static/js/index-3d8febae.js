import{E as e,a as t,f as a,l as s,d as i,m as o,n as l,o as r,v as n}from"./element-plus-fe2e4fed.js";import{_ as d}from"./course-840565f7.js";import{Q as c}from"./question-f32e2692.js";import{_ as p}from"./index-2e57a1f5.js";import{o as u,T as m,S as h,a as g,P as b,W as j,$ as C}from"./@vue-0361ad4a.js";import"./lodash-es-3593bb86.js";import"./async-validator-cf877c1f.js";import"./@vueuse-19751edd.js";import"./dayjs-3a594381.js";import"./call-bind-8544b80b.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-1634e2d0.js";import"./@popperjs-b78c3215.js";import"./escape-html-1590d737.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./data-97822b17.js";import"./vue-router-64e93849.js";import"./pinia-3f36854e.js";import"./axios-15f6fe35.js";import"./qs-c6aa5595.js";import"./side-channel-b02c3a2b.js";import"./object-inspect-bd98d4ca.js";import"./vue-clipboard2-259f629a.js";import"./clipboard-e6665d4e.js";import"./vue-ueditor-wrap-f5452c05.js";const f={class:"product-content"},_={class:"table-wrap"},w=["src"],y={class:"pagination"},S={class:"dialog-footer"};const z=p({components:{course:d},data:()=>({loading:!0,curPage:1,pageSize:20,totalDataNumber:0,formInline:{},cateList:[],listData:[],multipleSelection:[],formLabelWidth:"120px",dialogVisible:!1,type:"error",params:null,iscourse:!1,exclude_ids:[]}),props:["isPopUp","question_id"],watch:{isPopUp:function(e,t){e!=t&&e&&(this.dialogVisible=e,this.type="error",this.params=null,this.getData())}},created(){},methods:{selectableFunc:e=>"boolean"!=typeof e.noChoose||e.noChoose,handleCurrentChange(e){this.curPage=e,this.getData()},handleSizeChange(e){this.curPage=1,this.pageSize=e,this.getData()},getData(){let e=this,t=e.formInline;e.loading=!0,t.page=e.curPage,t.list_rows=e.pageSize,t.question_id=e.question_id,c.relationList(t,!0).then((t=>{e.loading=!1,e.listData=t.data.list.data,e.exclude_ids=t.data.list.data,e.totalDataNumber=t.data.list.total})).catch((e=>{}))},SingleFunc(e){this.multipleSelection=[e],this.addClerk()},addClerk(){let t=this,a=null;t.multipleSelection.length<1?e({message:"请至少选择一件产品课程！",type:"error"}):(a=t.multipleSelection[0],a.image=a.image[0].file_path,t.params=a,t.type="success",t.dialogVisible=!1)},dialogFormVisible(){this.$emit("closeDialog",{type:this.type,openDialog:!1,params:this.params})},tableCurrentChange(e){this.multipleSelection=e},addClick(){this.iscourse=!0},changeSort(t,a){let s=this;s.iscourse=!1;let i={id:a,sort:t};c.setsortRelation(i,!0).then((t=>{s.loading=!1,e({message:"操作成功",type:"success"}),s.getData()})).catch((e=>{}))},delFunc(a){let s=this;t.confirm("确认后将永久删除，确定删除该关联吗?","提示",{type:"warning"}).then((()=>{c.delRelation({id:a}).then((t=>{e({message:"删除成功",type:"success"}),s.getData()}))}))},closeFunc(e){let t=this;if(this.iscourse=!1,"success"==e.type){let a={question_id:t.question_id,course_id:[]};e.params.forEach(((e,t)=>{a.course_id.push(e.course_id)})),c.addRelation(a,!0).then((e=>{t.loading=!1,t.getData()})).catch((e=>{}))}}}},[["render",function(e,t,c,p,z,D){const V=a,k=s,v=i,x=o,F=l,P=d,q=r,U=n;return u(),m(q,{title:"知识点",modelValue:z.dialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>z.dialogVisible=e),onClose:D.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"900px","modal-append-to-body":!1},{footer:h((()=>[g("div",S,[b(V,{size:"small",onClick:t[0]||(t[0]=e=>z.dialogVisible=!1)},{default:h((()=>[j("取 消")])),_:1})])])),default:h((()=>[b(V,{class:"mb10",size:"small",type:"primary",icon:"Plus",onClick:D.addClick},{default:h((()=>[j("关联知识点")])),_:1},8,["onClick"]),g("div",f,[g("div",_,[C((u(),m(x,{size:"small",data:z.listData,border:"",style:{width:"100%"},"highlight-current-row":"",onSelectionChange:D.tableCurrentChange},{default:h((()=>[b(k,{type:"selection",selectable:D.selectableFunc,width:"44"},null,8,["selectable"]),b(k,{width:"70",label:"课程图片"},{default:h((e=>[g("img",{src:e.row.course.image.file_path,width:"30",height:"30"},null,8,w)])),_:1}),b(k,{prop:"course.title",label:"课程名称"}),b(k,{prop:"create_time",width:"140",label:"添加时间"}),b(k,{prop:"create_time",width:"100",label:"排序"},{default:h((e=>[b(v,{onBlur:t=>D.changeSort(e.row.sort,e.row.id),placeholder:"请输入选项内容",modelValue:e.row.sort,"onUpdate:modelValue":t=>e.row.sort=t},null,8,["onBlur","modelValue","onUpdate:modelValue"])])),_:1}),b(k,{width:"80",label:"操作"},{default:h((e=>[b(V,{size:"mini",onClick:t=>D.delFunc(e.row.id)},{default:h((()=>[j("移除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"])),[[U,z.loading]])]),g("div",y,[b(F,{onSizeChange:D.handleSizeChange,onCurrentChange:D.handleCurrentChange,background:"","current-page":z.curPage,"page-sizes":[2,10,20,50,100],"page-size":z.pageSize,layout:"total, prev, pager, next, jumper",total:z.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])]),b(P,{iscourse:z.iscourse,excludeIds:z.exclude_ids,islist:!0,onCloseDialog:D.closeFunc},null,8,["iscourse","excludeIds","onCloseDialog"])])),_:1},8,["modelValue","onClose"])}]]);export{z as default};
