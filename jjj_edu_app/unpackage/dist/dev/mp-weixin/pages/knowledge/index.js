"use strict";const a=require("../../common/vendor.js"),h={data(){return{searchName:"",category_id:0,phoneHeight:"",scrollviewHigh:"",page:1,list_rows:10,loading:!1,searchForm:{category_id:0,search:""},listData:[],last_page:1,no_more:!1,categorys:[]}},onLoad(){},onShow(){let e=this.$store._state.data.navTargetCategory;this.category_id=e||0,this.init(),this.page=1,this.listData=[],this.getCategory(),this.getData()},onHide(){this.$store.commit("changNavTargetCategory",0)},computed:{loadingType(){return this.loading?1:this.listData.length!=0&&this.no_more?2:0}},onReachBottom(){let e=this;e.page<e.last_page&&(e.page++,e.getData()),e.no_more=!0},methods:{init(){console.log("init");let e=this;a.index.getSystemInfo({success(s){e.phoneHeight=s.windowHeight,a.index.createSelectorQuery().select(".top-box").boundingClientRect(o=>{let i=e.phoneHeight-o.height;e.scrollviewHigh=i}).exec()}})},getData(){let e=this,s=e.page,g=e.list_rows;e.loading=!0,a.index.showLoading({title:"加载中"}),e._get("course.course/list",{page:s||1,list_rows:g,category_id:e.category_id||0,search:e.searchForm.search},function(o){e.listData=e.listData.concat(o.data.list.data),e.last_page=o.data.list.last_page,o.data.list.last_page<=1&&(e.no_more=!0),e.loading=!1,a.index.hideLoading()})},getCategory(){let e=this;e._get("course.category/index",{},function(s){e.categorys=s.data.list})},searchFunc(){this.page=1,this.listData=[],this.getData()},changeCat(e){let s=this;console.log("changeCat called with",e),s.category_id=e,s.page=1,s.listData=[],s.getData(),console.log(s.category_id)}}};function _(e,s,g,o,i,r){return{a:a.o(t=>r.searchFunc()),b:i.searchForm.search,c:a.o(t=>i.searchForm.search=t.detail.value),d:a.o((...t)=>r.searchFunc&&r.searchFunc(...t)),e:i.category_id==0?1:"",f:a.o(t=>r.changeCat(0)),g:a.f(i.categorys,(t,c,l)=>({a:a.t(t.name),b:c,c:i.category_id==t.category_id?1:"",d:a.o(n=>r.changeCat(t.category_id),c)})),h:a.f(i.listData,(t,c,l)=>a.e({a:t.image?t.image.file_path:"",b:a.t(t.title),c:t.isFree==1},t.isFree==1?{}:{},{d:t.isFree==2},t.isFree==2?{}:{},{e:t.isFree==3},t.isFree==3?{f:a.t(t.course_price)}:{},{g:a.t(t.sectionNum),h:c,i:a.o(n=>e.gotoPage("pages/knowledge/course/detail?course_id="+t.course_id),c)}))}}const d=a._export_sfc(h,[["render",_],["__file","D:/phpstudy_pro/www3/jjj_edu_small/jjj_edu_app/pages/knowledge/index.vue"]]);wx.createPage(d);
