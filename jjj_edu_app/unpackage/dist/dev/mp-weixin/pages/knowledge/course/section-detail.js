"use strict";const i=require("../../../common/vendor.js"),c=require("../../../common/utils.js"),a=()=>"./part/recourd.js",r=i.index.createInnerAudioContext(),l={components:{recourdVue:a},data(){return{section_id:null,course_id:null,course:{},detail:{},status:!1,beforeAudio:!0,duration:0,currentTime:0,progress:0,xpjAudio:null,videoPause:!1,videoContext:null,removeArea:{x:0,y:0}}},onReady(){this.videoContext=i.index.createVideoContext("video",this)},onLoad(e){this.videoPause=!1;let o=c.utils.getSceneData(e);this.section_id=e.section_id?e.section_id:o.sid,this.course_id=e.course_id?e.course_id:o.cid,this.getSystemInfo()},onShow(){this.status=!1},mounted(){this.getData()},beforeUnmount(){this.changeto()},methods:{getSystemInfo(){let e=this;i.index.getSystemInfo({success(o){e.removeArea.x=o.windowWidth-70,e.removeArea.y=o.windowHeight-120}})},initAudit(){r.src=this.detail.audio_link,this.getAudioInfo()},getAudioInfo(){r.onCanplay(()=>{r.duration,setTimeout(()=>{this.duration=r.duration,this.watchAuditTime()})})},watchAuditTime(){r.onTimeUpdate(()=>{const{currentTime:e,duration:o}=r;this.currentTime=e,this.duration==this.currentTime?(this.progress=100,this.status=!1):this.progress=e/o*100})},gotoRecourd(){this.$refs.recourdRef.open({section_id:this.section_id,course_id:this.course_id,payStatus:this.detail.payStatus})},startVideo(){this.videoPause=!0,this.$nextTick(()=>{this.videoContext.play()})},changeto(){this.status=!this.status,this.status?(r.play(),r.onPlay(()=>{console.log("播放!")})):(r.pause(),this.currenttime=r.currentTime)},getData(){let e=this,o=e.section_id,n=e.course_id;e.loadding=!0,i.index.showLoading({title:"加载中"}),e._get("course.course/sectionDetail",{course_id:n,section_id:o},function(u){const{data:{detail:{course:t,detail:s}}}=u;e.course=t,e.detail=s,e.initAudit(),e.loadding=!1,i.index.hideLoading()},function(u){})},changeSwiper(){this.isVideoPlay=!1},formatTime(e){e=Math.floor(e);let o=e%60;o<10&&(o="0"+o);let n=Math.floor(e/60);return n<10&&(n="0"+n),n+":"+o}}};Array||i.resolveComponent("recourdVue")();function h(e,o,n,u,t,s){return i.e({a:!e.loadding},e.loadding?{}:i.e({b:!t.videoPause},t.videoPause?{e:t.detail.video_link}:{c:t.detail.video_image,d:i.o((...d)=>s.startVideo&&s.startVideo(...d))},{f:i.t(t.detail.title),g:i.t(t.detail.update_time),h:t.detail.audio_image},t.detail.audio_image?i.e({i:t.detail.audio_image,j:i.t(t.detail.title),k:i.t(t.detail.update_time),l:!t.status},t.status?{n:i.o((...d)=>s.changeto&&s.changeto(...d))}:{m:i.o((...d)=>s.changeto&&s.changeto(...d))},{o:t.progress>0,p:`${t.progress}%`,q:i.t(s.formatTime(t.currentTime)),r:i.t(s.formatTime(t.duration))}):{},{s:t.detail.content},t.detail.content?{t:t.detail.content}:{},{v:i.o((...d)=>s.gotoRecourd&&s.gotoRecourd(...d)),w:t.removeArea.x,x:t.removeArea.y,y:i.sr("recourdRef","8784fb59-0"),z:i.p({list:t.course.section})}))}const _=i._export_sfc(l,[["render",h],["__scopeId","data-v-8784fb59"],["__file","D:/phpstudy_pro/www3/jjj_edu_small/jjj_edu_app/pages/knowledge/course/section-detail.vue"]]);wx.createPage(_);
