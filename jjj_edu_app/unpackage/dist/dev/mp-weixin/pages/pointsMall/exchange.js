"use strict";const r=require("../../common/vendor.js"),l={data(){return{loadding:!0,isAddressComplete:!1,params:{pay_source:"",product_id:0,total_num:1},detail:{},address:{},totalPrice:0,temlIds:[]}},onShow(){this.getData()},onLoad(e){this.params.pay_source=this.getPlatform(),e&&e.product_id&&(this.params.product_id=e.product_id),e&&e.total_num&&(this.params.total_num=e.total_num)},watch:{address:{handler(e){this.isAddressComplete=e&&e.name&&e.phone&&e.region},deep:!0}},methods:{getData(){let e=this;r.index.showLoading({title:"加载中"}),e._get("plus.points.order/buy",e.params,function(s){const{data:{order:o}}=s;e.temlIds=s.data.template_arr,e.detail=o,e.address=o.address,e.totalPrice=parseFloat(e.detail.total_price)+parseFloat(e.detail.express_price),e.loadding=!1,r.index.hideLoading()})},SubmitOrder(){let e=this;if(!e.isAddressComplete){r.index.showToast({icon:"none",title:"请完整填写收货地址"});return}let s={product_id:this.detail.product_id,total_num:this.params.total_num},o=function(){e._post("plus.points.order/buy",s,function(d){let t=`/pages/order/cashier?order_id=${d.data.order_id}&order_type=${d.data.order_type}`;e.gotoPage(t,"reLaunch")})};e.subMessage(e.temlIds,o)}}};Array||r.resolveComponent("u-icon")();const n=()=>"../../uni_modules/uview-plus/components/u-icon/u-icon.js";Math||n();function p(e,s,o,d,t,i){return r.e({a:t.address},t.address?{}:{},{b:r.p({width:"12rpx",height:"12rpx",color:"#999999",name:"arrow-right"}),c:r.o(a=>e.gotoPage("/pages/user/address/address")),d:t.address},t.address?r.e({e:r.t(t.address?t.address.name:""),f:r.t(t.address?t.address.phone:""),g:t.isAddressComplete},t.isAddressComplete?{h:r.t(t.address?t.address.region.province+t.address.region.city+t.address.region.region+t.address.detail:"")}:{}):{},{i:t.detail.file_path,j:r.t(t.detail.product_name),k:r.t(t.params.total_num),l:r.t(t.detail.product_price),m:r.t(t.detail.total_price),n:r.t(t.detail.express_price),o:r.t(t.detail.total_price)},{p:r.t(t.totalPrice)},{q:r.t(t.detail.total_points),r:r.o((...a)=>i.SubmitOrder&&i.SubmitOrder(...a))})}const c=r._export_sfc(l,[["render",p],["__scopeId","data-v-bf72fcd3"],["__file","D:/phpstudy_pro/www3/jjj_edu_small/jjj_edu_app/pages/pointsMall/exchange.vue"]]);wx.createPage(c);
