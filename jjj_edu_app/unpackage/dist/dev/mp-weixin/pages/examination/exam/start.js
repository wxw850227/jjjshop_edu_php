"use strict";const t=require("../../../common/vendor.js"),d={data(){return{paper_id:0,record_id:0,time:"",question:[],answer:[],Qsindex:0,clock:!1,examTime:0,timer:1,intTimer:null,examTimeText:"",model:null,muultipleStem:!0}},onLoad(e){this.paper_id=e.paper_id,this.model=e.model,this.getData(),this.$fire.on("Qsindex",s=>{this.Qsindex=s})},beforeDestroy(){clearInterval(this.intTimer),this.intTimer=null},watch:{},computed:{getExamTime(){let e=this.examTime;(this.detail&&this.detail.exam_time||0)*60;let s=parseInt(e/60/60%24);s=s<10?"0"+s:s;let n=parseInt(e/60%60);n=n<10?"0"+n:n;let u=parseInt(e%60);return u=u<10?"0"+u:u,s+":"+n+":"+u},qusetionStem(){return this.Qsindex=this.Qsindex||0,this.question&&this.question.length>0?this.question[this.Qsindex]:{question:{}}}},methods:{gotoCard(){let e=this;clearInterval(e.intTimer),e.intTimer=null;let s=`/pages/examination/exam/answerSheet?paper_id=${e.paper_id}&record_id=${e.record_id}&model=${e.model}`;t.index.navigateTo({url:s,success:function(){console.log("跳转成功")},fail:function(n){console.log("跳转失败",n)}})},FavFunc(e){let s=this;s._post("paper.Favorite/fav",{paper_id:s.paper_id,question_id:e.question_id,paper_question_id:e.paper_question_id},n=>{e.is_fav==1?(t.index.showToast({icon:"none",title:"取消成功"}),e.is_fav=0):(t.index.showToast({icon:"none",title:"收藏成功，请到“我的->我的收藏”查看和管理哦"}),e.is_fav=1)})},isSelect(e,s,n){return e.question.question_type==2?s.indexOf(n)!=-1:s===n},getData(){let e=this,s="paper.Paper/startAnswer";e._get(s,{paper_id:e.paper_id},n=>{e.detail=n.data.detail,e.record_id=n.data.detail.record_id,e.question=e.detail.question,e.checkHistory()})},checkHistory(){let e=this,s=t.index.getStorageSync("examTime")||{};this.examTime=s[e.record_id]||0,this.intTimer=setInterval(function(){e.examTime++,e.timer===2&&e.recordHistory(e.examTime),e.timer++},1e3)},recordHistory(e){let s=this,n=t.index.getStorageSync("examTime")||{};n[s.record_id]=e,t.index.setStorageSync("examTime",n),this.timer=1},subAnser(){let e=this,s=e.question[e.Qsindex].answer;if(!s||e.clock)return;let n=e.question[e.Qsindex].id;e.clock=!0;let u="paper.Paper/submitAnswer";e._get(u,{id:n,answer:s},r=>{e.clock=!1,e.question[e.Qsindex].answer_state=1},r=>{e.clock=!1})},slectAn(e,s){let n=this.question[e];if(this.model=="practice"){if(n.question.question_type!=2&&this.qusetionStem.answer)return;if(n.question.question_type==2&&this.qusetionStem.answer&&this.muultipleStem)return}if(n.question.question_type!=2)n.answer=this.getIndex(s);else{let u=n.answer||[],r=this.getIndex(s);typeof u=="string"&&(u=n.answer.split(","));let i=u.indexOf(r);i>-1?u.splice(i,1):u.push(this.getIndex(s)),n.answer=u.join(",")}this.model=="practice"?n.question.question_type!=2?(this.muultipleStem=!0,this.subAnser()):n.question.question_type==2&&(this.muultipleStem=!1):n.question.question_type!=2&&(this.subAnser(),setTimeout(()=>{this.Qsindex<this.question.length-1&&(this.Qsindex=this.Qsindex+1)},400))},getNum(e){return String.fromCharCode(e-65)},getIndex(e){return String.fromCharCode(e+65)},previous(){this.Qsindex<1||this.clock||this.Qsindex--},next(){if(this.Qsindex+1>=this.question.length||this.clock){this.subAnser(),this.gotoCard();return}this.subAnser(),this.Qsindex++},multiNext(){if(this.Qsindex+1>=this.question.length||this.clock){this.muultipleStem=!0,this.subAnser();return}this.model=="practice"?(this.muultipleStem=!0,this.subAnser()):(this.subAnser(),this.Qsindex++)},subFunc(){let e=this;e._post("paper.Paper/submit",{record_id:e.detail.record_id},s=>{t.index.showModal({content:"时间到，试卷已提交",success(){e.gotoPage("/pages/examination/record/detail?paper_id="+e.detail.paper_id)}}),clearInterval(e.intTimer),e.intTimer=null})},allSubExam(){let e=!1;return this.question&&this.question.length>0&&(e=this.question.every(s=>s.answer_state>0)),e}}};if(!Array){const e=t.resolveComponent("u-icon"),s=t.resolveComponent("u-rate"),n=t.resolveComponent("u-parse");(e+s+n)()}const h=()=>"../../../uni_modules/uview-plus/components/u-icon/u-icon.js",p=()=>"../../../uni_modules/uview-plus/components/u-rate/u-rate.js",_=()=>"../../../uni_modules/uview-plus/components/u-parse/u-parse.js";Math||(h+p+_)();function g(e,s,n,u,r,i){return t.e({a:t.p({size:"42rpx",name:"/static/image/datika.png"}),b:t.o((...o)=>i.gotoCard&&i.gotoCard(...o)),c:r.model!="practice"},r.model!="practice"?{d:t.p({size:"46rpx",name:"/static/image/time.png"}),e:t.t(i.getExamTime)}:{},{f:t.f(r.question,(o,a,c)=>t.e({a:r.Qsindex==a},r.Qsindex==a?t.e({b:"35033437-2-"+c,c:t.p({width:"96rpx",height:"92rpx",name:"/static/image/tixing_bg.png"}),d:t.t(o.question.type_name),e:t.t(a+1),f:t.t(r.question.length),g:t.t(o.question.title),h:t.f(o.question.option,(l,m,x)=>t.e({a:t.t(i.getIndex(m)),b:l.type==1},l.type==1?{c:t.t(l.content)}:{d:l.content},{e:t.o(f=>i.slectAn(a,m),m),f:i.isSelect(o,o.answer,i.getIndex(m))?1:"",g:m})),i:i.qusetionStem.question&&i.qusetionStem.question.question_type==2&&!(this.model=="practice"&&this.qusetionStem.answer&&this.muultipleStem)},i.qusetionStem.question&&i.qusetionStem.question.question_type==2&&!(this.model=="practice"&&this.qusetionStem.answer&&this.muultipleStem)?{j:t.o((...l)=>i.multiNext&&i.multiNext(...l),a)}:{}):{},{k:a})),g:r.model=="practice"&&i.qusetionStem.answer&&r.muultipleStem},r.model=="practice"&&i.qusetionStem.answer&&r.muultipleStem?t.e({h:t.t(i.qusetionStem.answer),i:t.t(i.qusetionStem.question&&i.qusetionStem.question.answer),j:i.qusetionStem.answer==i.qusetionStem.question.answer},i.qusetionStem.answer==i.qusetionStem.question.answer?{}:{},{k:t.p({count:"5",value:i.qusetionStem.question.difficulty,readonly:!0,activeColor:"#F2473F"})},t.e({l:t.p({content:i.qusetionStem.question.analysis}),m:i.qusetionStem.question.knowledge&&i.qusetionStem.question.knowledge.length>0},i.qusetionStem.question.knowledge&&i.qusetionStem.question.knowledge.length>0?{n:t.f(i.qusetionStem.question.knowledge,(o,a,c)=>({a:t.t(o.course.title),b:"35033437-5-"+c,c:t.o(l=>e.gotoPage("pages/knowledge/course/detail?course_id="+o.course_id),a),d:a})),o:t.p({name:"arrow-right",bold:!0,color:"#F2473F",size:"30rpx"})}:{})):{},{p:r.Qsindex==0},r.Qsindex==0?{q:t.p({width:"52rpx",height:"60rpx",name:"/static/image/back_icon.png"})}:{r:t.p({size:"52rpx",name:"/static/image/back_icon1.png"})},{s:t.o((...o)=>i.previous&&i.previous(...o)),t:t.p({size:"74rpx",name:r.question[r.Qsindex]&&r.question[r.Qsindex].is_fav==1?"/static/image/shoucang_a.png":"/static/image/shoucang_p.png"}),v:t.o(o=>i.FavFunc(r.question[r.Qsindex])),w:r.question&&r.question.length-1==r.Qsindex},r.question&&r.question.length-1==r.Qsindex?{x:t.p({width:"52rpx",height:"60rpx",name:"/static/image/next_icon.png"})}:{y:t.p({width:"52rpx",height:"60rpx",name:"/static/image/next_icon1.png"})},{z:t.o((...o)=>i.next&&i.next(...o))})}const q=t._export_sfc(d,[["render",g],["__scopeId","data-v-35033437"],["__file","D:/phpstudy_pro/www3/jjj_edu_small/jjj_edu_app/pages/examination/exam/start.vue"]]);wx.createPage(q);
