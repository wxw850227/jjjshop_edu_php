"use strict";const a=require("../../common/vendor.js"),n=require("../../common/pay.js"),y={data(){return{balance:"",balanceType:!1,type:0,loading:!0,order_id:0,order_type:0,pay_type:20,checkedPay:[],payPrice:"",type:""}},computed:{hasBanlance(){return this.checkedPay.indexOf(10)!=-1}},onLoad(e){this.order_id=e.order_id,e.order_type&&(this.order_type=e.order_type),this.type=e.type,this.order_type!=30&&this.order_type!=20&&(console.log("-------------------------"),a.wx$1.enableAlertBeforeUnload({message:"您的订单如在规定时间内未支付将被取消，请尽快完成支付",success:function(r){console.log("方法注册成功：",r)},fail:function(r){console.log("方法注册失败：",r)}})),this.getData()},onBackPress(e){if(this.order_type!=30&&this.order_type!=20)return e.from==="navigateBack"?(console.log(),!0):(this.back(),!0)},methods:{back(){let e=this;a.index.showModal({title:"提示",content:"您的订单如在规定时间内未支付将被取消，请尽快完成支付",cancelText:"继续支付",confirmText:"确认离开",success:function(r){if(r.confirm){let t="";e.type=="course"?t="/pages/order/course":e.type=="eduadmin"?t="/pages/order/teacher":e.type=="paper"&&(t="/pages/order/exam"),e.gotoPage(`${t}`,"reLaunch")}else r.cancel&&(a.index.navigateBack(),console.log("用户点击取消"))}})},getData(){let e=this;e.loading=!0,a.index.showLoading({title:"加载中"});let r;e.order_type==20&&(r="balance.Plan/pay"),e.order_type==30&&(r="plus.points.order/pay"),e.order_type==10&&(r="user.Order/pay");let t={order_id:e.order_id,pay_source:e.getPlatform()};e._get(r,t,function(p){e.loading=!1;let o=[];p.data.payTypes.payType.forEach(c=>{o.push(c*1)}),e.checkedPay=o,e.payPrice=p.data.payPrice,e.balance=p.data.balance||"",e.checkedPay[0]!=10?e.pay_type=e.checkedPay[0]||e.checkedPay[1]||20:e.pay_type=e.checkedPay[1]||e.checkedPay[0],a.index.hideLoading()})},switch2Change(e){this.balanceType=e.detail.value},submit(){let e=this;e.loading=!0,a.index.showLoading({title:"加载中"});let r="user.order/pay";e.order_type==20&&(r="balance.Plan/pay"),e.order_type==30&&(r="plus.points.order/pay"),e.order_type==10&&(r="user.Order/pay");let t=e.balanceType==!0?1:0;e.payPrice==0&&(t=1);let p=e.pay_type;p==10&&(p=0);let o={order_id:e.order_id,pay_source:e.getPlatform(),payType:p,use_balance:t};e._post(r,o,function(c){e.loading=!1,a.index.hideLoading(),n.pay(c,e,e.paySuccess,e.payError)})},paySuccess(e){let r=this;r.order_type==30?r.gotoPage(`/pages/order/paySuccess/course?order_id=${e.data.order_id}&order_type=point`,"reLaunch"):r.order_type==10&&r.gotoPage(`/pages/order/paySuccess/course?order_id=${e.data.order_id}&order_type=${r.type}`,"reLaunch")},payError(e){let r=this,t="";r.type=="course"?t="/pages/order/course":r.type=="eduadmin"?t="/pages/order/teacher":r.type=="paper"&&(t="/pages/order/exam"),r.gotoPage(`${t}`,"redirect")},payTypeFunc(e){this.pay_type=e}}};function l(e,r,t,p,o,c){return a.e({a:a.t(o.payPrice||""),b:a.f(o.checkedPay,(i,s,_)=>a.e({a:i==20},i==20?{b:a.n(o.pay_type==20?"item active":"item"),c:a.o(d=>c.payTypeFunc(20),s)}:{},{d:i==30},i==30?{e:a.n(o.pay_type==30?"item active":"item"),f:a.o(d=>c.payTypeFunc(30),s)}:{},{g:s})),c:c.hasBanlance&&o.balance>0},c.hasBanlance&&o.balance>0?{d:a.t(o.balance),e:e.getThemeColor(),f:o.balanceType,g:a.o((...i)=>c.switch2Change&&c.switch2Change(...i))}:{},{h:a.o((...i)=>c.submit&&c.submit(...i)),i:e.theme(),j:a.n(e.theme()||"")})}const u=a._export_sfc(y,[["render",l],["__scopeId","data-v-91467d41"],["__file","D:/phpstudy_pro/www3/jjj_edu_small/jjj_edu_app/pages/order/cashier.vue"]]);wx.createPage(u);
