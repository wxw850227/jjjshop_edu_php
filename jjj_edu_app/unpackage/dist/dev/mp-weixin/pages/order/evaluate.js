"use strict";const r=require("../../common/vendor.js"),g=()=>"../../components/upload/upload.js",m={components:{Upload:g},data(){return{loadding:!0,order_id:"",lecturer_id:"",lecturerDetail:{},paramsLecturer:{image_list:[]},tableData:[],score:10,isUpload:!1,image_id:[],img:"/static/temp/photo.jpg",index:""}},onLoad(e){e.order_id?(this.order_id=e.order_id,this.getCourse()):e.lecturer_id&&(this.lecturer_id=e.lecturer_id,this.getLecturer())},methods:{getCourse(){let e=this,l=e.order_id;e.loadding=!0,r.index.showLoading({title:"加载中"}),e._get("course.Comment/order",{order_id:l},function(a){e.tableData=a.data.order.product,e.tableData.forEach((s,t)=>{e.tableData[t].score=10,e.tableData[t].image_list=[]}),e.loadding=!1,r.index.hideLoading()})},getLecturer(){let e=this,l=e.lecturer_id;e._get("lecturer.Comment/add",{lecturer_id:l},function(a){const{data:{detail:s}}=a;e.lecturerDetail=s,e.paramsLecturer.score=10,e.loadding=!1,r.index.hideLoading()})},gradeFunc(e,l,a){e.score=l,this.tableData[a]=e},changScore(e){this.paramsLecturer.score=e},formSubmit:function(e){this.order_id?this.saveOrder():this.lecturer_id&&this.saveLecturer()},saveOrder(){let e=this,l=e.order_id,a={};this.tableData&&this.tableData.length>0&&this.tableData.forEach(s=>{a.image_list=s.image_list,a.content=s.content,a.score=s.score}),e._post("course.comment/order",{order_id:l,formData:JSON.stringify(a)},function(s){e.showSuccess("评价成功！",function(){e.gotoPage("/pages/order/category","redirect")})})},saveLecturer(){let e=this,l=e.lecturer_id;e._post("lecturer.Comment/add ",{lecturer_id:l,formData:JSON.stringify(e.paramsLecturer)},function(a){e.showSuccess("评价成功！",function(){e.gotoPage(`/pages/knowledge/lecturer/detail?lecturer_id=${l}`,"redirect")})})},openUpload(e){this.index=e,this.isUpload=!0},getImgsFunc(e){let l=this;if(e&&typeof e<"u")if(l.order_id){let a=l.index;l.tableData[a].image_list=l.tableData[a].image_list.concat(e)}else l.lecturer_id&&(l.paramsLecturer.image_list=l.paramsLecturer.image_list.concat(e));l.isUpload=!1},deleteImg(e,l,a){e=="order"?this.tableData[l].image_list.splice(a,1):e=="lecturer"&&this.paramsLecturer.image_list.splice(a,1)}}};if(!Array){const e=r.resolveComponent("u-icon"),l=r.resolveComponent("Upload");(e+l)()}const p=()=>"../../uni_modules/uview-plus/components/u-icon/u-icon.js";Math||p();function h(e,l,a,s,t,o){return r.e({a:!t.loadding},t.loadding?{}:r.e({b:t.order_id},t.order_id?{c:r.f(t.tableData,(c,i,u)=>r.e({a:c.image.file_path,b:r.t(c.product_name),c:r.t(c.product_price),d:r.n(c.score==10?"flex-1 d-c-c active":"flex-1 d-c-c"),e:r.o(d=>o.gradeFunc(c,10,i),i),f:r.n(c.score==20?"flex-1 d-c-c active":"flex-1 d-c-c"),g:r.o(d=>o.gradeFunc(c,20,i),i),h:r.n(c.score==30?"flex-1 d-c-c active":"flex-1 d-c-c"),i:r.o(d=>o.gradeFunc(c,30,i),i),j:c.content,k:r.o(d=>c.content=d.detail.value,i),l:r.f(c.image_list,(d,n,_)=>({a:"e310f63a-0-"+u+"-"+_,b:r.o(f=>o.deleteImg("lecturer",i,n),n),c:d.file_path,d:n,e:r.o(f=>o.deleteImg("order",i,n),n)})),m:c.image_list.length<9},c.image_list.length<9?{n:r.o(d=>o.openUpload(i),i)}:{},{o:i})),d:r.p({name:"close-circle-fill",color:"#999999",size:"32rpx"})}:t.lecturer_id?r.e({f:t.lecturerDetail.image&&t.lecturerDetail.image.file_path,g:r.t(t.lecturerDetail.name),h:t.lecturerDetail.label&&t.lecturerDetail.label.length>0},t.lecturerDetail.label&&t.lecturerDetail.label.length>0?{i:r.t(t.lecturerDetail.label[0])}:{},{j:r.t(t.lecturerDetail.describe),k:r.n(t.paramsLecturer.score==10?"flex-1 d-c-c active":"flex-1 d-c-c"),l:r.o(c=>o.changScore(10)),m:r.n(t.paramsLecturer.score==20?"flex-1 d-c-c active":"flex-1 d-c-c"),n:r.o(c=>o.changScore(20)),o:r.n(t.paramsLecturer.score==30?"flex-1 d-c-c active":"flex-1 d-c-c"),p:r.o(c=>o.changScore(30)),q:t.paramsLecturer.content,r:r.o(c=>t.paramsLecturer.content=c.detail.value),s:r.f(t.paramsLecturer.image_list,(c,i,u)=>({a:"e310f63a-1-"+u,b:r.o(d=>o.deleteImg("lecturer",t.index,i),i),c:c.file_path,d:i})),t:r.p({name:"close-circle-fill",color:"#999999",size:"32rpx"}),v:t.paramsLecturer.image_list.length<9},t.paramsLecturer.image_list.length<9?{w:r.o(c=>o.openUpload(t.index))}:{}):{},{e:t.lecturer_id,x:r.o((...c)=>o.formSubmit&&o.formSubmit(...c)),y:r.o((...c)=>e.formReset&&e.formReset(...c)),z:t.isUpload},t.isUpload?{A:r.o(o.getImgsFunc)}:{}))}const v=r._export_sfc(m,[["render",h],["__scopeId","data-v-e310f63a"],["__file","D:/phpstudy_pro/www3/jjj_edu_small/jjj_edu_app/pages/order/evaluate.vue"]]);wx.createPage(v);
