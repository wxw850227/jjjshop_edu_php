"use strict";const e=require("../../common/vendor.js"),l={data(){return{formData:{mobile:""},loging_password:"",register:{mobile:"",password:"",repassword:""},ip:"",isShow:!0,is_login:1,phoneHeight:0,isRead:!1}},onLoad(){this.getData()},onShow(){this.init()},methods:{returnHome(){e.index.switchTab({url:"/pages/index/index"})},init(){let i=this;e.index.getSystemInfo({success(t){i.phoneHeight=t.windowHeight}})},getData(){let i=this;i._get("user.userapple/policy",{},function(t){i.service=t.data.service,i.privacy=t.data.privacy})},formSubmit(){let i=this,t={mobile:i.formData.mobile},n="";if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(i.formData.mobile)){console.log(i.formData.mobile),e.index.showToast({title:"手机有误,请重填！",duration:2e3,icon:"none"});return}if(i.loging_password==""){e.index.showToast({title:"密码不能为空！",duration:2e3,icon:"none"});return}if(t.password=i.loging_password,n="user.useropen/phonelogin",!i.isRead){e.index.showToast({title:"请同意并勾选协议内容",duration:2e3,icon:"none"});return}e.index.showLoading({title:"正在提交"}),i._post(n,t,g=>{e.index.setStorageSync("token",g.data.token),e.index.setStorageSync("user_id",g.data.user_id);let r="/"+e.index.getStorageSync("currentPage"),s=e.index.getStorageSync("currentPageOptions");if(Object.keys(s).length>0){r+="?";for(let o in s)r+=o+"="+s[o]+"&";r=r.substring(0,r.length-1)}i.gotoPage(r)},!1,()=>{e.index.hideLoading()})},registerSub(){let i=this;if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(i.register.mobile)){console.log(i.register.mobile),e.index.showToast({title:"手机有误,请重填！",duration:2e3,icon:"none"});return}if(i.register.password.length<6){e.index.showToast({title:"密码至少6位数！",duration:2e3,icon:"none"});return}if(i.register.password!==i.register.repassword){e.index.showToast({title:"两次密码输入不一致！",duration:2e3,icon:"none"});return}if(!i.isRead){e.index.showToast({title:"请同意并勾选协议内容",duration:2e3,icon:"none"});return}i.register.invitation_id=e.index.getStorageSync("invitation_id")?e.index.getStorageSync("invitation_id"):0,i.register.reg_source="h5",i.register.referee_id=e.index.getStorageSync("referee_id"),e.index.showLoading({title:"正在提交"}),i._post("user.useropen/register",i.register,t=>{e.index.showToast({title:"注册成功",duration:3e3}),i.formData.mobile=i.register.mobile,i.register={mobile:"",password:"",repassword:""},i.is_login=1},!1,()=>{e.index.hideLoading()})},xieyi(i){let t="";i=="service"?t=this.service:t=this.privacy,e.index.navigateTo({url:"/pages/webview/webview?url="+t})}}};function a(i,t,n,g,r,s){return e.e({a:e.o((...o)=>s.returnHome&&s.returnHome(...o)),b:r.is_login==2},r.is_login==2?{c:e.o(o=>r.is_login=1),d:i.is_send,e:r.register.mobile,f:e.o(o=>r.register.mobile=o.detail.value),g:r.register.password,h:e.o(o=>r.register.password=o.detail.value),i:r.register.repassword,j:e.o(o=>r.register.repassword=o.detail.value)}:{},{k:r.is_login==1},r.is_login==1?{l:e.o(o=>r.is_login=2),m:r.formData.mobile,n:e.o(o=>r.formData.mobile=o.detail.value),o:r.loging_password,p:e.o(o=>r.loging_password=o.detail.value)}:{},{q:e.n(r.isRead?"active agreement":"agreement"),r:e.o(o=>s.xieyi("service")),s:e.o(o=>s.xieyi("privacy")),t:e.o(o=>r.isRead=!r.isRead),v:r.is_login==2},r.is_login==2?{w:e.o((...o)=>s.registerSub&&s.registerSub(...o))}:{},{x:r.is_login==1},r.is_login==1?{y:e.o((...o)=>s.formSubmit&&s.formSubmit(...o))}:{},{z:e.s("height: "+r.phoneHeight+"px;")})}const d=e._export_sfc(l,[["render",a],["__scopeId","data-v-761a79ba"],["__file","D:/phpstudy_pro/www3/jjj_edu_small/jjj_edu_app/pages/login/weblogin.vue"]]);wx.createPage(d);
